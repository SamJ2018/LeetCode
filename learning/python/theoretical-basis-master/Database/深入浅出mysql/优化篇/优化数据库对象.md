# 优化数据库对象

## 优化表的数据类型

> 根据应用判断，考虑字段长度留有冗余，而又不要留过大的冗余

- 可以使用函数`PROCEDURE ANALYSE()`对当前应用的表进行分析
  - 根据输出信息，可以发现是否需要优化，会给出一系列的统计值，如最大长度、最小长度、最大值、最小值、平均值
  - 并会给出建议优化的类型

eg:

```mysql
select * from table_name procedure analyse()\G;
```

## 通过拆分提高表的访问效率

### 垂直拆分

- 把主码和一些列放到一个表，然后把主码和另外的列放到另一个表中
  - 适用于某些列查用某些列不常用
    - 优点：一个数据页能存放更多的数据，查询时减少I/O次数
    - 缺点：需要管理冗余列，查询所有数据需要联合操作

### 水平拆分

- 根据一列或多列数据的值把数据行放到两个独立的表中。
  - 适用于：表很大，分割厚可以降低在查询时需要读的数据和索引的页数；表中的数据本身就有独立性；需要把数据存放到多个介质上
    - 缺点：会给应用增加复杂度，水平拆分要考虑数据量的增长速度

## 逆规范化

> 反规范的好处是降低连接操作的需求、降低外码和索引的数目，还可以减少表的数目，相应问题是数据的完整性。

### 常用的反规范技术

#### 增加冗余列

- 在多个表中具有相同的列，用来查询时避免连接操作

#### 增加派生列

- 查询时减少连接操作

#### 重新组表

- 如果许多用户需要查看两个表连接出来的结果数据，则把两个表重新组成一个表来减少连接

### 反规范技术维护数据的完整性

#### 批处理维护

对复制列或派生列的修改机类一定时间后，运行一批处理作业或存储过程对复制或派生列进行修改

#### 应用逻辑

#### 触发器

对数据的任何修改立即触发对复制列或派生列的对应修改

## 使用中间表提高统计查询速度

优点

- 中间表复制源表部分数据，并且于原表相互隔离，不会对源表产生负面影响
- 可以灵活的添加索引所增加临时用的新字段